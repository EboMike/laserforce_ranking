from tortoise import BaseDBAsyncClient


async def upgrade(db: BaseDBAsyncClient) -> str:
    return """
        ALTER TABLE `playerstates` DROP FOREIGN KEY `fk_playerst_events_b6dccfc0`;
        ALTER TABLE `entitystarts` ADD `member_id` VARCHAR(50);
        ALTER TABLE `events` MODIFY COLUMN `type` VARCHAR(4) NOT NULL  COMMENT 'MISSION_START: 0100\nMISSION_END: 0101\nSHOT_EMPTY: 0200\nMISS: 0201\nMISS_BASE: 0202\nHIT_BASE: 0203\nDESTROY_BASE: 0204\nDAMAGED_OPPONENT: 0205\nDOWNED_OPPONENT: 0206\nDAMANGED_TEAM: 0207\nDOWNED_TEAM: 0208\nLOCKING: 0300\nMISSILE_BASE_MISS: 0301\nMISSILE_BASE_DAMAGE: 0302\nMISISLE_BASE_DESTROY: 0303\nMISSILE_MISS: 0304\nMISSILE_DAMAGE_OPPONENT: 0305\nMISSILE_DOWN_OPPONENT: 0306\nMISSILE_DAMAGE_TEAM: 0307\nMISSILE_DOWN_TEAM: 0308\nACTIVATE_RAPID_FIRE: 0400\nDEACTIVATE_RAPID_FIRE: 0401\nACTIVATE_NUKE: 0404\nDETONATE_NUKE: 0405\nRESUPPLY_AMMO: 0500\nRESUPPLY_LIVES: 0502\nAMMO_BOOST: 0510\nLIFE_BOOST: 0512\nPENALTY: 0600\nACHIEVEMENT: 0900\nREWARD: 0902\nBASE_AWARDED: 0B03\nPASS: 1100\nGOAL: 1101\nASSIST: 1102\nSTEAL: 1103\nBLOCK: 1104\nROUND_START: 1105\nROUND_END: 1106\nGETS_BALL: 1107\nTIME_VIOLATION: 1108\nCLEAR: 1109\nFAIL_CLEAR: 110A';
        ALTER TABLE `playerstates` ADD `state` SMALLINT NOT NULL  COMMENT 'ACTIVE: 0\nUNKNOWN: 1\nRESETTABLE: 2\nDOWN: 3';
        ALTER TABLE `playerstates` DROP COLUMN `state_id`;"""


async def downgrade(db: BaseDBAsyncClient) -> str:
    return """
        ALTER TABLE `events` MODIFY COLUMN `type` VARCHAR(4) NOT NULL  COMMENT 'MISSION_START: 0100\nMISSION_END: 0101\nSHOT_EMPTY: 0200\nMISS: 0201\nMISS_BASE: 0202\nHIT_BASE: 0203\nDESTROY_BASE: 0204\nDAMAGED_OPPONENT: 0205\nDOWNED_OPPONENT: 0206\nDAMANGED_TEAM: 0207\nDOWNED_TEAM: 0208\nLOCKING: 0300\nMISSILE_BASE_MISS: 0301\nMISSILE_BASE_DAMAGE: 0302\nMISISLE_BASE_DESTROY: 0303\nMISSILE_MISS: 0304\nMISSILE_DAMAGE_OPPONENT: 0305\nMISSILE_DOWN_OPPONENT: 0306\nMISSILE_DAMAGE_TEAM: 0307\nMISSILE_DOWN_TEAM: 0308\nACTIVATE_RAPID_FIRE: 0400\nDEACTIVATE_RAPID_FIRE: 0401\nACTIVATE_NUKE: 0404\nDETONATE_NUKE: 0405\nRESUPPLY_AMMO: 0500\nRESUPPLY_LIVES: 0502\nAMMO_BOOST: 0510\nLIFE_BOOST: 0512\nPENALTY: 0600\nACHIEVEMENT: 0900\nREWARD: 0902\nBASE_AWARDED: 0B03\nPASS: 1100\nGOAL: 1101\nSTEAL: 1103\nBLOCK: 1104\nROUND_START: 1105\nROUND_END: 1106\nGETS_BALL: 1107\nCLEAR: 1109\nFAIL_CLEAR: 110A';
        ALTER TABLE `entitystarts` DROP COLUMN `member_id`;
        ALTER TABLE `playerstates` ADD `state_id` INT NOT NULL;
        ALTER TABLE `playerstates` DROP COLUMN `state`;
        ALTER TABLE `playerstates` ADD CONSTRAINT `fk_playerst_events_b6dccfc0` FOREIGN KEY (`state_id`) REFERENCES `events` (`id`) ON DELETE CASCADE;"""
